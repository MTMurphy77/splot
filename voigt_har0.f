      double precision function voigt_harris4(a,v)
      implicit none
      real*8 a,v,v0,v1,v2
      real*8 h0(41),h1(81),h2(41)
      integer n,n1
      data h0/ 1.000000000000,
     : 0.990049833749, 0.960789439152, 0.913931185271, 0.852143788966,
     : 0.778800783071, 0.697676326071, 0.612626394184, 0.527292424043,
     : 0.444858066223, 0.367879441171, 0.298197279430, 0.236927758682,
     : 0.184519523993, 0.140858420921, 0.105399224562, 0.077304740443,
     : 0.055576212611, 0.039163895099, 0.027051846866, 0.018315638889,
     : 0.012155178330, 0.007907054052, 0.005041760260, 0.003151111598,
     : 0.001930454136, 0.001159229174, 0.000682328053, 0.000393669041,
     : 0.000222629857, 0.000123409804, 0.000067054824, 0.000035712850,
     : 0.000018643742, 0.000009540163, 0.000004785117, 0.000002352575,
     : 0.000001133727, 0.000000535535, 0.000000247960, 0.000000112535/
      data h1/-1.128379167095,
     :-1.105961434222,-1.040477963566,-0.937029757432,-0.803456986018,
     :-0.649453994194,-0.485523677115,-0.321920166521,-0.167719197466,
     :-0.030123465589, 0.085936244587, 0.177894274488, 0.245373261783,
     : 0.289805621816, 0.313937950975, 0.321302823327, 0.315729136407,
     : 0.300940739727, 0.280269039091, 0.256483307941, 0.231725701169,
     : 0.207527821831, 0.184881929309, 0.164341205701, 0.146128111736,
     : 0.130235955964, 0.116514905038, 0.104738816042, 0.094653018548,
     : 0.086005466678, 0.078564735130, 0.072128484933, 0.066525624003,
     : 0.061614728196, 0.057280580350, 0.053430052964, 0.049988061429,
     : 0.046893958263, 0.044098507510, 0.041561443660, 0.039249552106,
     : 0.035195110371, 0.031762013521, 0.028824299698, 0.026287782116,
     : 0.024080451215, 0.022146249546, 0.020440876102, 0.018928867283,
     : 0.017581513466, 0.016375340534, 0.015290983532, 0.014312338410,
     : 0.013425914606, 0.012620335051, 0.011885945815, 0.011214508434,
     : 0.010598955211, 0.010033193029, 0.009511944856, 0.009030620816,
     : 0.008585212626, 0.008172206631, 0.007788511773, 0.007431399584,
     : 0.007098453971, 0.006787528984, 0.006496713130, 0.006224299123,
     : 0.005968758094, 0.005728717562, 0.005502942519, 0.005290319149,
     : 0.005089840768, 0.004900595632, 0.004721756347, 0.004552570635,
     : 0.004392353260, 0.004240478963, 0.004096376239, 0.003959521873/
      data h2/ 1.000000000000,
     : 0.970248837074, 0.883926284020, 0.749423571922, 0.579457776497,
     : 0.389400391536, 0.195349371300, 0.012252527884,-0.147641878732,
     :-0.275812001058,-0.367879441171,-0.423440136790,-0.445424186322,
     :-0.439156467103,-0.411306589089,-0.368897285967,-0.318495530626,
     :-0.265654296283,-0.214618145142,-0.168262487509,-0.128209472221,
     :-0.095053494540,-0.068633229168,-0.048300063288,-0.033149694016,
     :-0.022200222567,-0.014513549257,-0.009266014956,-0.005779061517,
     :-0.003522004336,-0.002097966669,-0.001221738899,-0.000695686311,
     :-0.000387416966,-0.000211028403,-0.000112450259,-0.000058626174,
     :-0.000029907722,-0.000014930710,-0.000007294971,-0.000003488590/
      if (v.lt.0.d0) v = -v
      if (a.eq.0.d0) goto 3
      v0 = v*10.d0
      n = int(v0)
      if (n.lt.40) goto 1
      if (n.lt.120) goto 2
      voigt_harris4 = (0.56419d0 + 0.846d0 / (v*v)) / (v*v)*a
      return
 1    v1 = dble(n)
      n = n+1
      v2 = v0-v1
      n1 = n+1
      voigt_harris4 = v2*(h0(n1)-h0(n)+a*(h1(n1)-h1(n)+
     :     a*(h2(n1)-h2(n))))+h0(n)+a*(h1(n)+a*h2(n))
      return
 2    n = n/2 + 20
      v1 = dble(n-20) * 2.d0
      n = n+1
      v2 = (v0-v1) / 2.d0
      n1 = n+1
      voigt_harris4 = a*((h1(n1)-h1(n))*v2+h1(n))
      return
 3    voigt_harris4 = dexp(-(v*v))   
      return
      end
